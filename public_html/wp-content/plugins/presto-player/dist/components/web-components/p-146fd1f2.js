import{l as n,a as r}from"./p-219091ba.js";import{P as e}from"./p-771734f3.js";export default function(t){var a=t.config,o=t.selector,i=t.src,u=t.preload;return new Promise(function(){var t=n(regeneratorRuntime.mark((function n(t){var c,s,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(window.Hls){n.next=6;break}case 1:if(window.hasOwnProperty("Hls")){n.next=6;break}return n.next=4,new Promise((function(n){return setTimeout(n,50)}));case 4:n.next=1;break;case 6:if(!window.Hls.isSupported()){n.next=16;break}return s=!["metadata","none"].includes(u),null!==(c=wp)&&void 0!==c&&c.blocks&&(s=!0),(f=new window.Hls({autoStartLoad:s})).loadSource(i),f.on(window.Hls.Events.LEVEL_SWITCHED,(function(n,r){o.closest(".presto-player__wrapper").querySelector(".plyr__menu__container [data-plyr='quality'][value='0'] span").innerHTML=f.autoLevelEnabled?"AUTO (".concat(f.levels[r.level].height,"p)"):"AUTO"})),f.on(window.Hls.Events.MANIFEST_PARSED,(function(){var n=f.levels.map((function(n){return n.height}));n.unshift(0);var i=n.findIndex((function(n){var r;return n===parseInt(null===(r=prestoPlayer)||void 0===r?void 0:r.hls_start_level)}));f.startLevel=i?i-1:2,a.quality={default:0,options:n,forced:!0,onChange:function(n){0===n?prestoHLS.currentLevel=-1:prestoHLS.levels.forEach((function(r,e){r.height===n&&(console.log("Found quality match with "+n),prestoHLS.currentLevel=e)}))}},f.attachMedia(o),window.prestoHLS=f;var u=new e(o,r({},a));return u.hls=f,u.on("waiting",(function n(){f.startLoad(-1),u.off("waiting",n)})),u.on("languagechange",(function(){setTimeout((function(){return f.subtitleTrack=u.currentTrack}),50)})),t(u)})),n.abrupt("return");case 16:if(!o.canPlayType("application/vnd.apple.mpegurl")){n.next=18;break}return n.abrupt("return",t(new e(o,r({},a))));case 18:return n.abrupt("return",t(new e(o,r({},a))));case 19:case"end":return n.stop()}}),n)})));return function(n,r){return t.apply(this,arguments)}}())}